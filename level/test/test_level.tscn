[gd_scene load_steps=12 format=3 uid="uid://bxvy3qa8esorq"]

[ext_resource type="Shader" path="res://level/background/misty-lake/water.gdshader" id="1_5h8xj"]
[ext_resource type="Script" path="res://entity/utility/Spawner.gd" id="1_fv3k8"]
[ext_resource type="Texture2D" uid="uid://eriecmar2l3j" path="res://level/background/misty-lake/water-day.tres" id="2_su2rp"]
[ext_resource type="Texture2D" uid="uid://bgh4r80tk5o7v" path="res://level/background/misty-lake/water-noise.tres" id="3_6g7e0"]
[ext_resource type="Script" path="res://level/test/opening1.gd" id="4_86fwn"]
[ext_resource type="PackedScene" uid="uid://duxqllhcbuvfa" path="res://level/test/corner.tscn" id="8_1a0fm"]
[ext_resource type="PackedScene" uid="uid://6wuhmc2p8byc" path="res://level/background/misty-lake/fog.tscn" id="8_ixvn3"]
[ext_resource type="PackedScene" uid="uid://uiwkegjhrq51" path="res://level/background/misty-lake/fog_overlay.tscn" id="9_v1onv"]

[sub_resource type="ViewportTexture" id="ViewportTexture_tmbaf"]
viewport_path = NodePath("SubViewportContainer/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_r8js3"]
resource_local_to_scene = true
shader = ExtResource("1_5h8xj")
shader_parameter/reflection = SubResource("ViewportTexture_tmbaf")
shader_parameter/water_velocity = Vector2(0, -0.2)
shader_parameter/water_opacity = 0.5
shader_parameter/color_map = ExtResource("2_su2rp")
shader_parameter/wave_velocity = Vector2(0, 2)
shader_parameter/wave_distortion = 0.2
shader_parameter/wave_multiplyer = -6.0

[sub_resource type="Curve2D" id="Curve2D_7y75u"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, -88, 315, -60.0678, -33.371, 60.0678, 33.371, 104, 214, 206.489, -19.6541, -206.489, 19.6541, 238, 559, -182.076, -213.9, 182.076, 213.9, 460, 232, 0, 0, 0, 0, 674, 440)
}
point_count = 5

[node name="test level" type="Node2D"]

[node name="Sprite2D" type="Sprite2D" parent="."]
texture_repeat = 2
material = SubResource("ShaderMaterial_r8js3")
texture = ExtResource("3_6g7e0")
centered = false

[node name="SubViewportContainer" type="SubViewportContainer" parent="."]
z_index = 2
custom_minimum_size = Vector2(540, 960)
offset_right = 540.0
offset_bottom = 960.0
stretch = true

[node name="SubViewport" type="SubViewport" parent="SubViewportContainer"]
disable_3d = true
transparent_bg = true
handle_input_locally = false
snap_2d_transforms_to_pixel = true
size = Vector2i(540, 960)
render_target_update_mode = 4

[node name="opening1" type="Node2D" parent="SubViewportContainer/SubViewport"]
script = ExtResource("4_86fwn")
paths = Array[NodePath]([NodePath("corner"), NodePath("corner2"), NodePath("LevelTimer"), NodePath("Spawner1/Timer")])

[node name="Spawner1" type="Node2D" parent="SubViewportContainer/SubViewport/opening1" node_paths=PackedStringArray("container")]
script = ExtResource("1_fv3k8")
container = NodePath("")

[node name="Timer" type="Timer" parent="SubViewportContainer/SubViewport/opening1/Spawner1"]

[node name="corner" parent="SubViewportContainer/SubViewport/opening1" instance=ExtResource("8_1a0fm")]

[node name="corner2" parent="SubViewportContainer/SubViewport/opening1" instance=ExtResource("8_1a0fm")]
rotation = 3.14159
scale = Vector2(1, -1)

[node name="LevelTimer" type="Timer" parent="SubViewportContainer/SubViewport/opening1"]
wait_time = 20.0
one_shot = true

[node name="fog" parent="." instance=ExtResource("8_ixvn3")]
visible = false

[node name="FogOverlay" parent="." instance=ExtResource("9_v1onv")]
visible = false

[node name="Path2D" type="Path2D" parent="."]
position = Vector2(-13, 5)
curve = SubResource("Curve2D_7y75u")

[connection signal="timeout" from="SubViewportContainer/SubViewport/opening1/Spawner1/Timer" to="SubViewportContainer/SubViewport/opening1/Spawner1" method="_on_timer_timeout"]
[connection signal="timeout" from="SubViewportContainer/SubViewport/opening1/LevelTimer" to="SubViewportContainer/SubViewport/opening1" method="_on_level_timer_timeout"]
